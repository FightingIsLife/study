## 什么是线程？
java线程是java程序中执行的单元。一个java程序可以运行多个线程，每个线程可以独立执行不同的任务。线程的执行是并发的，即多个线程可以同时执行。

## 线程的特点：
1. 轻量级：线程的开销和销毁相对较小，可以创建大量的线程。
2. 共享内存：多个线程可以共享同一块内存区域，这使得线程之间可以方便的进行通信
3. 独立调度：每个线程的执行由操作系统进行调度，具有非确定性，无法预测线程的执行顺序

## 线程的创建方式：
1. 继承Thread类，重写run方法，通过start方法来启动线程
2. 实现Runnable接口的run方法，创建thread对象时，传入Runnable子类的对象，通过start方法来启动线程


## 线程有哪些状态：
1. NEW
2. RUNNABLE
3. TIMED_WAITING
4. WAITING
5. BLOCKED
6. TERMINATED

## synchronized 原理：

由jvm实现的互斥同步的一种方式，由synchronized修饰的程序块编译后的字节码，在编译前后生成了monitorenter 和monitorexit 字节码指令
在虚拟机执行到monitorenter时，首先要尝试获取对象锁，如果这个对象没有锁定，或者当前对象已经获得了该锁，则把锁的计数器+1，当monitorexit时，计数器减1
当计数器为0时，则锁被释放。


## jvm对synchronized做了哪些优化：

jdk6之前，使用操作系统的互斥锁实现，用户态切换到内核态执行，代价非常昂贵

优化方案：自旋锁，线程在阻塞等待之前，自旋等待一段时间，降低内核态切换的概率

1. 偏向锁： 当对象处于无锁状态，jvm会利用cas操作，将对象头的markWord部分设置为线程id,以表示这个对象偏向当前线程，在绝大部分场景，一个对象同时被一个对象锁定
2. 轻量级锁：如果对象处于被另一个线程锁住且处于偏向锁状态， jvm就撤销偏向锁，切换到轻量级锁，使用cas操作markWord来试图获取锁，如果成功就使用轻量级锁，否则升级为重量级锁
3. 重量级锁： 使用操作系统的互斥锁实现

## synchronized非公平锁原因：没有阻塞队列

## 锁消除和锁粗化：
1. 锁消除：虚拟机即时编译器在运行时，对一些代码上要求同步，但被检测到不可能存在共享数据竞争的锁进行消除，主要根据逃逸分析。
2. 锁粗化: 如果一系列的连续操作，都对同一个对象反复加锁释放锁，频繁的操作导致不必要的性能损耗，增大锁的作用域


## 和synchronized 相比，reentrantLock有什么不同
synchronized基于对象头实现，reentrantLock实现Lock接口，底层基于aqs框架实现，可以指定公平与非公平

